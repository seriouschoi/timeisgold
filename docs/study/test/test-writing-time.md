# 테스트 코드의 작성에 대한 기준.

## 무엇을 테스트할 것인가?
정상적인 동작 흐름에서 기대한 동작을 하는지를 검증하면 된다.
예외 상황들을 과도하게 테스트를 하면,
실제 비지니스 로직과 상관없는 방어로직을 추가하게 되고,
테스트 유지보수 비용이 상승하여 유지보수가 어려워진다.

예를 들면, 루틴1의 id로 루틴2를 저장할때, 
루틴1의 내용을 잘못 덮어쓸 수 있는 오류이므로, 허용하면 안될것 같지만,
현실은 루틴1을 불러온 사용자가 루틴2의 내용으로 편집할 수도 있다.
즉 도메인 규칙에서 허용할 수 있는 내용이다.

이를 예외로 다루게 되면, 이후 개발되며 수정되는 시나리오와 불필요한 충돌을 일으키게 된다.
테스트를 만드는 시점에서 모든 예외케이스가 막 떠오를수 있지만,
현실적인 개발은 정상플로우만 테스트를 해도 테스트는 제 역할을 충분히 해낸다.

추후 바뀌는 코드와 의존성에서도 정상동작을 보장해주는 지표가 되기 때문이다.


## 테스트의 작성 시점.
하나의 기능이 마무리되었을때가 가장 적절하다고 생각한다.
이때가 정상 동작 플로우가 정리가 된 시점이기 때문이다.

# 테스트를 언제 작성할건가?

## 개발중 테스트 작성.
1. 장점.
   1. 리팩토링이나 기능 추가할때마다 버그를 바로 잡아준다.
   2. 테스트가 가능한 구조를 개발하며 불필요한 결합 발생을 피할 수 있다.
2. 단점.
   1. 개발중 도메인 컨트랙트가 자주 바뀌는건 일어날 수 있는 일이고, 이때마다 테스트가 계속 깨지면서 수정 비용이 상승한다.

## 기능 하나 완료후 테스트 작성.
1. 아직 개발 방향을 잡는 단계라면, 테스트는 만들지 않는게 맞다.
2. 리턴형을 단순 결과 리턴을 할 수도 있고, Flow를 쓸수도 있고, DomainResult로 감쌀수 있고, 각 계층마다 감쌀 수도 있다.
3. 이 상황을 처음부터 예측할 수는 없기 때문에, 개발 과정에서 이런 내용들이 정리가 되고,
4. 때문에 정리가 완료되는 시점, 내 생각엔 :feature:some-feature 모듈 하나 정도 완료되는 시점이 가장 적절하다고 본다.
5. 이 시점에 테스트를 작성하게 되면, 개발중 발생한 리팩토링에 의한 사이드이펙트도 확인이 가능하다.
6. 실무 입장에서도, 프로토타입 개발된것을 기획자나 디자이너에게 전달을 하고,
7. 개발자는 자동화된 테스트 개발이라는 경영진이 아주 좋아할만한 명분으로 테스트에 집중을 해서 개발을 할 수 있게 된다.
8. 이렇게 만들어진 테스트는 정상동작 플로우에 대한 고정적인 명세가 될것이며,
9. 향후 기능 추가/라이브러리나 프레임워크의 버전이 변경되었을때도, 기능 동작을 보장하는 안정 장치가 될 것이다.